<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 我都做了哪些来复活本博客的 | TaoAlpha's Blog</title><meta name="description" content="记录下我都做了那些事情来重新让本博客满血复活的."><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:title" content="我都做了哪些来复活本博客的 | TaoAlpha's Blog"><meta property="og:description" content="记录下我都做了那些事情来重新让本博客满血复活的."><meta property="og:url" content="undefined"><meta property="og:image" content="http://taoalpha.github.io/images/newblog.jpg"><meta property="og:type" content="website"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.6.0/hint.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="TaoAlpha's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="TaoAlpha's Blog" type="application/rss+xml">
</head><body class="post"><aside class="home-menu"><nav class="home-icon-con upside"><a href="/blog/" class="home-menu-icon brand">涛</a><a href="/blog/timeline" class="home-menu-icon"><i class="fas fa-map-marker-alt"></i></a><a aria-label="Click to take you to the search box." class="home-menu-icon search-trigger hint--right"><i class="fas fa-search"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact hidden"><a href="https://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="https://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="https://taoalpha.github.io" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="https://douban.com/people/129154019" target="something"><img src="https://img3.doubanio.com/favicon.ico" alt="douban"></a></div></nav><nav class="home-icon-con downside"><a href="/blog/rss2.xml" class="home-menu-icon rss"><i class="fas fa-rss"></i></a><a href="/blog/about/" class="home-menu-icon"><i class="fas fa-smile"></i></a><span id="dark-mode" class="home-menu-icon hidden"><i class="fas fa-adjust"></i></span></nav></aside><div class="stars"></div><div class="twinkling"></div><div id="progress-bar" class="hidden"><span class="bg"></span></div><article id="content"><div class="main"><section class="entry"><h1 class="entry-title">我都做了哪些来复活本博客的</h1><div class="meta-top"><a href="https://taoalpha.github.io"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2020-07-01</span><span class="wordage">2819 words</span><span class="readspeed">9 minutes to read</span></div><div class="entry-content"><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>因为上次写博客是在两年前了, 再上次是四年前, 本博客其实有很多组件都慢慢的不工作了, 本来以为只是小小的检修一下即可, 结果发现还是做了不少事情的, 感觉值得记录一下.</p>
<h2 id="主旨"><a href="#主旨" class="headerlink" title="主旨"></a>主旨</h2><h3 id="Outdated-Dependencies"><a href="#Outdated-Dependencies" class="headerlink" title="Outdated Dependencies"></a>Outdated Dependencies</h3><p>博客是利用<a href="https://hexo.io/" target="_blank" rel="noopener">hexo</a>搭建的, 因为好久没碰, 所以有不少组件都已经过期了, 比如 hexo 本身都已经到4.x 了, 而我更新之前还在用3.1.0, 本来有点担心有 breaking change, 结果发现毫无问题, 无缝升级 (当然可能只是我还没发现). 于是自然也就把所有用到的组件都升级一下, 非常的顺利, 可以说是整个过程中最顺利的一环了, 当然, 也是因为这一步这么的顺利, 所以才更加激发了我复活这个博客的动力!</p>
<h3 id="自制主题"><a href="#自制主题" class="headerlink" title="自制主题"></a>自制主题</h3><p>这个博客的主题是一个<a href="https://github.com/taoalpha/hexo-theme-tao" target="_blank" rel="noopener">自制主题</a>, 我其实也开源了, 不过除我之外, 可能也没杀人用 lol. 当然在我自己看了一下好几年前写的这个主题的代码, 也就可以理解为啥没人用了, 里面很多可以 abstract 出来的都硬写在 theme 了, 想要拿来用的话, 需要改很多主题本身的代码才行, 这当然不适合用来分享, 毕竟好的主题都是拿来即用的.</p>
<p>我暂时并没有计划推广这个主题, 不过我确实准备把整个主题重写一下, 至少要替换掉那些 es6 文件们… 哈哈, 而且整体 layout 也可以精简一下, 该抽象的抽象出来, 争取使它成为一个可以让人装上就能用的主题 :)</p>
<h3 id="图片组件"><a href="#图片组件" class="headerlink" title="图片组件"></a>图片组件</h3><p>严格来说这是主题的一部分, 因为之前用的 <a href="https://api.desktoppr.co/1/wallpapers/random" target="_blank" rel="noopener">https://api.desktoppr.co/1/wallpapers/random</a> 不能用了, 我本来留着备用的 <a href="https://www.dailywallppr.com/" target="_blank" rel="noopener">https://www.dailywallppr.com/</a> 也不好使了, 所以干脆找起了替代品. 查了查发现不少人推荐 <a href="https://pixabay.com/" target="_blank" rel="noopener">https://pixabay.com</a>, 我看图片质量也不错, API free tier 也相当够用 (5000 queries / hour), 齐活, 就它了.</p>
<p>考虑到过往经验来看, 博客配图为自然景观的时候最好看, 所以我就简单限制了 api 返回结果局限在 <code>nature</code> 这个关键词上了. 目前来看, 效果相当不错嘛.</p>
<p>基本逻辑都没变, 不过考虑到 rate limit, 我还是加了点缓存的, 对于那些在本网站上花的时间比较长的人, 尽量减少一些请求数. 而且主要是解决了之前的一个 bug, 因为之前请求一旦出错会自动重试, 而且无限制重试… 所以之前博客打开以后就会给 desktoppr 狂发请求 lol 这次也限制了最多的重试次数. 以后可以考虑加上 exponential backoff 的重试机制.</p>
<h3 id="天气-API"><a href="#天气-API" class="headerlink" title="天气 API"></a>天气 API</h3><p>必须夸奖一下 <a href="https://api.openweathermap.org/" target="_blank" rel="noopener">https://api.openweathermap.org</a>, 用了这么久依然很好使, 除了终于更换了 https 以外. 当然实际上 github pages 很久以前也全部更换为了 https, 考虑到浏览器, 尤其是 chrome 开始限制混合请求, 所以天气请求慢慢就不能用了. 这次也只替换了 https 就好使了!</p>
<h3 id="评论系统"><a href="#评论系统" class="headerlink" title="评论系统"></a>评论系统</h3><p>之前一直使用多说, 不过多说在 17 年的时候停服了, 当然我似乎 17 年之后也没怎么写过博客了… 所以评论系统相当于一直关闭了… 既然打算复活博客, 那么怎么能少了评论呢? 查了一下现在的静态网站弄潮儿们都在使用的评论系统, 果不其然发现了 <a href="/blog/2020/06/30/tech-gitment-and-gittalk/" title="gitment 和 gitalk">gitment 和 gitalk</a> 两个基于 github issues 的解决方案, 想到本身网站也是基于 github pages 的, github 全家桶果断入! 具体的集成方案请参考 <a href="/blog/2020/06/30/tech-gitment-and-gittalk/" title="博客复活第一文: gitment 和 gitalk">博客复活第一文: gitment 和 gitalk</a>.</p>
<h3 id="Puzzles"><a href="#Puzzles" class="headerlink" title="Puzzles"></a>Puzzles</h3><p>这是之前博客的一个单独页面, 记载了一些我在学习 js 的路上的困惑和问题, 本意是长期维护下来作为自己的一个私人 Q&amp;A wiki 的感觉, 不过除了一开始添加的 3, 4 条内容外, 就再没更新了… 不过我还是挺喜欢这个时间轴的设计感的, 于是就把它转换了一下, 改成了记录我个人人生旅程的时间轴 ;) <a href="/blog/timeline/">欢迎查看</a></p>
<h3 id="Pageview-amp-GA"><a href="#Pageview-amp-GA" class="headerlink" title="Pageview &amp; GA"></a>Pageview &amp; GA</h3><p>很早以前我添加了一个功能来显示每篇文章的阅读数, 这个功能还是很喜欢的, 非常不想要丢弃, 一开始我也没发现它不正常了, 因为 api 也还是返回看起来毫无问题的数据, 直到我最新的三篇文章发表后, 一直不显示点击数, 我就觉得有点奇怪了, 毕竟我自己点击了好几次呀 :) 于是翻看了一下最初实现这个功能的博文 <a href="/blog/2015/06/07/tech-add-google-analytics-pageviews-to-jekyll-blog/" title="如何给 Jekyll 博文添加阅读数显示">如何给 Jekyll 博文添加阅读数显示</a>, 顺藤摸瓜的重启了我之前的 GAE, 当然现在都在 gcloud 上了 :) 我很惊奇它居然还在工作… 当然一直报错显示 OAuth token 错误, 一开始我以为是过期了, 就查看了一下代码, 比对了一下 gcloud 上的 Oauth key, 发现并没有问题, 又猜测可能是 GA 服务是不是因为更新又被停用了? 于是查看了下 API &amp; Servies, 发现 GA 还是启用的状态… 差不多绝望的时候, 我看到了管理后台上的 revoke authentication, 一狠心点了进去, 然后重新 grant 了一下, 居然就好了… 感谢老天! 感谢<a href="https://developers.google.com/analytics/solutions/google-analytics-super-proxy" target="_blank" rel="noopener">google-analytics-super-proxy</a>, 居然七年没维护的项目依然好用到爆.. 当然还要感谢一下 GA API 的稳定性, 羡慕, 希望有朝一日我也能设计出这么稳定的 API :)</p>
<h3 id="Swiftype"><a href="#Swiftype" class="headerlink" title="Swiftype"></a>Swiftype</h3><p><a href="https://swiftype.com/" target="_blank" rel="noopener">Swiftype</a> 是一个提供自定义搜索引擎和嵌入式搜索的服务, 非常适合用来给你的静态网站添加强有力的搜索服务, 我一开始都把它彻底给忘了, 还以为我依然再用我之前第一版本的硬编码搜索, 结果实验了一下搜索功能才发现是 swiftype, 瞬间换回了记忆. 当然我一开始集成 swiftype 的时候域名还是 taoalpha.me, 所以只能重置了一下几年前的那个引擎, 重新对着新域名爬了一遍. 挺速度的, 感觉爬了几分钟就开始可以搜索了 :)</p>
<h3 id="Sitemap-amp-Rss"><a href="#Sitemap-amp-Rss" class="headerlink" title="Sitemap &amp; Rss"></a>Sitemap &amp; Rss</h3><p>也是在重置搜索的时候, 发现之前的 sitemap 也失效了, 本来使用自定义插件实现的最新文章也因为我重置 repo 丢失了, 搜了一下果然有人做了类似的功能, 看起来也很简单, 就加上了 hexo-generator-sitemap 以及 hexo-generator-feed 两个插件.</p>
<h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>当然还有一些简单的修修补补, 就不一一列举了, 总的来说, 经过了这么几番折腾, 我的博客算是满血复活啦!!! 撒花!!! 我也加上了关于的页面, 去掉了 tipme 的页面, 当然也确实没几个 tip :) 等流量上来后, 我也许会加上哦 :-)</p>
</div><div class="post-info"><span class="category"><i class="fas fa-briefcase"></i><a href="/blog/categories/tech">tech</a></span><span class="tags"><i class="fas fa-tags"></i><a href="/blog/tags/hexo">hexo</a><a href="/blog/tags/Google-Analytics">Google Analytics</a><a href="/blog/tags/pixabay">pixabay</a></span></div></section><div class="widgets"><aside id="menuIndex" class="sidenav hidden"></aside><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><div class="related-posts sidenav"><h2>Related Posts:</h2><ul class="article-list"><li><a href="/blog/2015/07/09/tech-add-goaccess-like-log-page-for-your-jekyll/">给你的 Jekyll 博客添加日志汇总展示页面</a></li><li><a href="/blog/2015/06/07/tech-add-google-analytics-pageviews-to-jekyll-blog/">如何给 Jekyll 博文添加阅读数显示</a></li></ul></div><aside class="sidenav"><div class="recent-posts"><h2>Recent Posts:</h2><ul class="article-list"><li><a href="/blog/2020/07/06/thoughts-recommendation-to-new-grads-on-job-choices/">给新计算机毕业生在工作选择上的一些建议</a></li><li><a href="/blog/2020/07/04/travel-working-holiday-visa-3/">打工度假 (三)</a></li><li><a href="/blog/2020/07/02/travel-working-holiday-visa-2/">打工度假 (二)</a></li><li><a href="/blog/2020/07/01/travel-working-holiday-visa/">打工度假 (一)</a></li></ul></div></aside></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><div class="comments"><script>const gitment = new Gitment({
  id: new Date('Wed Jul 01 2020 21:31:31 GMT-0400').toISOString(),
  owner: 'taoalpha',
  repo: 'blog',
  oauth: {
    client_id: '875872ffb3955d0ffe20',
    client_secret: '46040668c536860a9e2e9a8508c513309e3840b5',
  },
});
gitment.render(document.querySelector('.comments'));
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>