<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Docker 101 minimalist web dev docker | TaoAlpha's Blog</title><meta name="description" content="Docker 101 minimalist web dev docker"><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:title" content="Docker 101 minimalist web dev docker | TaoAlpha's Blog"><meta property="og:description" content="Docker 101 minimalist web dev docker"><meta property="og:url" content="undefined"><meta property="og:image" content="http://taoalpha.github.io/images/newblog.jpg"><meta property="og:type" content="website"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.6.0/hint.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="TaoAlpha's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="TaoAlpha's Blog" type="application/rss+xml">
</head><body class="post"><aside class="home-menu"><nav class="home-icon-con upside"><a href="/blog/" class="home-menu-icon brand">涛</a><a href="/blog/timeline" class="home-menu-icon"><i class="fas fa-map-marker-alt"></i></a><a aria-label="Click to take you to the search box." class="home-menu-icon search-trigger hint--right"><i class="fas fa-search"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact hidden"><a href="https://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="https://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="https://taoalpha.github.io" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="https://douban.com/people/129154019" target="something"><img src="https://img3.doubanio.com/favicon.ico" alt="douban"></a></div></nav><nav class="home-icon-con downside"><a href="/blog/rss2.xml" class="home-menu-icon rss"><i class="fas fa-rss"></i></a><a href="/blog/about/" class="home-menu-icon"><i class="fas fa-smile"></i></a><span id="dark-mode" class="home-menu-icon hidden"><i class="fas fa-adjust"></i></span></nav></aside><div class="stars"></div><div class="twinkling"></div><div id="progress-bar" class="hidden"><span class="bg"></span></div><article id="content"><div class="main"><section class="entry"><h1 class="entry-title">Docker 101 minimalist web dev docker</h1><div class="meta-top"><a href="https://taoalpha.github.io"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2016-04-27</span><span class="wordage">5412 words</span><span class="readspeed">16 minutes to read</span></div><div class="entry-content"><h2 id="Write-ahead"><a href="#Write-ahead" class="headerlink" title="Write ahead"></a>Write ahead</h2><p>After we knew some basic ideas and commands of Docker (No? see Docker 101 self-learning tutorial). We can build our own docker images and customized our dev kit.</p>
<p>Today I will show you how to use Dockerfile build your own images, here I build a minimalist web dev image as example:</p>
<h2 id="Let’s-code"><a href="#Let’s-code" class="headerlink" title="Let’s code"></a>Let’s code</h2><h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>Dockerfile is a config doc that descripe how you want to assemble an image. And then use docker build [name-of-image] [path-to-dockerfile] build the image.</p>
<p>Here are the most common commands you can use in your Dockerfile.</p>
<p>All commands are not case-sensitive, but normally we use all UPPERCASE:</p>
<ol>
<li>FROM<br>Using FROM <image>:<tag> or FROM <iamge>@<digest> so you can build your image based on the image you want to set as base image. Since most images build on top of some images, so a FROM must be the first non-comment instruction in the Dockerfile.</li>
<li>MAINTAINER<br>Using MAINTAINER <name> so you can specify the Author field of the image you generated.</li>
<li>RUN<br>This is the most useful and common commands in Dockerfile, you can use it run any commands the image you use support, mostly are shell commands: RUN <command> or RUN [“executable”, “param1”, “param2”].</li>
<li>CMD<br>The main purpose of a CMD is to provide defaults for an executing container: CMD [“executable”,”param1”,”param2”], CMD [“param1”,”param2”], CMD command param1 param2. One Dockerfile can only have one CMD instruction, if you have multiple, the latest one will be used.</li>
<li>LABEL<br>Same as MAINTAINER, you can use it add some metadata to an image:LABEL <key>=<value> <key>=<value> <key>=<value> …</li>
<li>EXPOSE<br>The EXPOSE instruction informs Docker that the container listens on the specified network ports at runtime. EXPOSE does not make the ports of the container accessible to the host. To do that, you must use either the -p flag to publish a range of ports or the -P flag to publish all of the exposed ports.<br>Normally we use -p while creating a container instead of expose while building the image.</li>
<li>ENV<br>Treat this as variable delcaration like var in javascript. After you declare a variable, you can use it anytime after by referring the name of the variable: ENV <key> <value>, ENV <key>=<value> …</li>
<li>ADD<br>If you want to copy files to the image, you should use ADD: ADD <src>… <dest> or ADD [“<src>“,… “<dest>“].<br>You can also use url as src to download a file from the url, or if you use path , then the path to the src should be relative to the context of build, and if the src is a recognised compression format, it will be unpacked.</li>
<li>COPY<br>Pretty much the same as ADD, but limited version (can not use url and won’t unpack the compressions). Actually deprecated after 1.1.2.</li>
<li>ENTRYPOINT<br>An ENTRYPOINT allows you to configure a container that will run as an executable. Like you assign a default command you want it to run after you use this image create any container. ENTRYPOINT [“executable”, “param1”, “param2”] or ENTRYPOINT command param1 param2. And all parameters after docker run <image> will be added to the ENTRYPOINT.</li>
<li>VOLUME<br>If you want to mount your local files as a volume to the image, you should use this command. VOLUME [“/data”]</li>
<li>USER<br>Use to set the user name or UID to use when running the image and also for any RUN / CMD commands.</li>
<li>WORKDIR<br>The entry point for you image (pwd).</li>
</ol>
<p>All you want to know about Dockerfile can be found from <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener">this link</a>.</p>
<h2 id="Minimalist-Web-Dev-Docker"><a href="#Minimalist-Web-Dev-Docker" class="headerlink" title="Minimalist Web Dev Docker"></a>Minimalist Web Dev Docker</h2><p>Now let’s build our own Dockerfile to assemble a minimalist web dev image. First, let’s give a list of requirements we need for this image:</p>
<ul>
<li>node@latest</li>
<li>npm@latest</li>
<li>zsh ( I love zsh )</li>
<li>vim / git / curl</li>
<li>Default settings for zsh and vim: oh-my-zsh, amix/vimrc.</li>
</ul>
<p>Since we want a minimalist image, we can not use ubuntu or other powerful linux, we should use alpine, the smallest linux I ever seen. And thanks for <a href="https://github.com/mhart/alpine-node" target="_blank" rel="noopener">@mhart</a>, he built a base image for node env based on alpine. So we can just use his shoulder :)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># always use the latest :)</span></span><br><span class="line">FROM mhart/alpine-node:latest</span><br><span class="line">MAINTAINER &lt;your_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># set your workspace which would be your WORKDIR</span></span><br><span class="line">ENV WORKSPACE /root</span><br><span class="line"></span><br><span class="line">RUN apk --update add \</span><br><span class="line">      vim \</span><br><span class="line">      git \</span><br><span class="line">      zsh \</span><br><span class="line">      curl</span><br><span class="line"></span><br><span class="line"><span class="comment"># put all your settings for zsh and vim in another shell script and copy to your image</span></span><br><span class="line">ADD scripts/initialized.sh <span class="variable">$&#123;WORKSPACE&#125;</span>/initialized.sh</span><br><span class="line"><span class="comment"># Run the script to set your vim and zsh</span></span><br><span class="line">RUN sh <span class="variable">$&#123;WORKSPACE&#125;</span>/initialized.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the workdir</span></span><br><span class="line">WORKDIR <span class="variable">$&#123;WORKSPACE&#125;</span></span><br><span class="line">And <span class="keyword">for</span> you initialized.sh:</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set up conf for vim</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/amix/vimrc.git ~/.vim_runtime</span><br><span class="line">sh ~/.vim_runtime/install_awesome_vimrc.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># set up conf for zsh and replace bash with zsh as default</span></span><br><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##### Below would totally depends on you #####</span></span><br><span class="line"><span class="comment"># set up the vim with customized plugins and configs</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mxw/vim-jsx ~/.vim_runtime/sources_non_forked/vim-jsx</span><br><span class="line">git <span class="built_in">clone</span> git://github.com/tpope/vim-unimpaired.git ~/.vim_runtime/sources_non_forked/vim-unimpaired</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mattn/emmet-vim ~/.vim_runtime/sources_non_forked/emmet-vim</span><br><span class="line"></span><br><span class="line"><span class="comment"># pull the configs</span></span><br><span class="line">git <span class="built_in">clone</span> https://gist.github.com/89b072c8d6c34d91047be1421b23d8bc.git /tmp/a</span><br><span class="line">mv /tmp/a/my_configs.vim ~/.vim_runtime/</span><br><span class="line"></span><br><span class="line"><span class="comment"># clean the temp files</span></span><br><span class="line">rm -rf /tmp/*</span><br></pre></td></tr></table></figure>
<p>Now you have a minimalist image to start your web dev which roughly ~100M .</p>
<h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>Since we did not install python, g++ and other tools, so if you want to use node-sass and some packages like it that need to be compiled before using, you may have to add these packages by yourself :)</p>
</div><div class="post-info"><span class="category"><i class="fas fa-briefcase"></i><a href="/blog/categories/tech">tech</a></span><span class="tags"><i class="fas fa-tags"></i><a href="/blog/tags/docker">docker</a></span></div></section><div class="widgets"><aside id="menuIndex" class="sidenav hidden"></aside><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><aside class="sidenav series"><h2>In Serie: The way I learn Docker<i class="fas fa-arrow-down expand"></i><i class="collapse fas fa-arrow-up"></i></h2><ul class="article-list hidden"><li><a href="/blog/2016/03/10/tech-docker-101-self-learning-tutorial/" data-id='0'>Docker 101 self-learning tutorial</a></li><li><a href="/blog/2016/04/27/tech-docker-101-minimalist-web-dev-docker/" data-id='1' class="current">Docker 101 minimalist web dev docker</a></li></ul></aside><div class="related-posts sidenav"><h2>Related Posts:</h2><ul class="article-list"><li><a href="/blog/2016/03/10/tech-docker-101-self-learning-tutorial/">Docker 101 self-learning tutorial</a></li></ul></div><aside class="sidenav"><div class="recent-posts"><h2>Recent Posts:</h2><ul class="article-list"><li><a href="/blog/2020/07/04/travel-working-holiday-visa-3/">打工度假 (三)</a></li><li><a href="/blog/2020/07/02/travel-working-holiday-visa-2/">打工度假 (二)</a></li><li><a href="/blog/2020/07/02/tech-what-i-have-done-to-restart-this-blog/">我都做了哪些来复活本博客的</a></li><li><a href="/blog/2020/07/01/travel-working-holiday-visa/">打工度假 (一)</a></li><li><a href="/blog/2020/06/30/tech-gitment-and-gittalk/">Gitment and Gitalk</a></li></ul></div></aside></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><div class="comments"><script>const gitment = new Gitment({
  id: new Date('Wed Apr 27 2016 07:00:00 GMT-0400').toISOString(),
  owner: 'taoalpha',
  repo: 'blog',
  oauth: {
    client_id: '875872ffb3955d0ffe20',
    client_secret: '46040668c536860a9e2e9a8508c513309e3840b5',
  },
});
gitment.render(document.querySelector('.comments'));
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>