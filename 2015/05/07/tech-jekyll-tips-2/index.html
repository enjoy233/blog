<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Jekyll 筛选 tag 的实现 | TaoAlpha's Blog</title><meta name="description" content="主要介绍下如何实现不同category下tag的展现以及筛选的实现, 效果模拟简书的tag"><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:title" content="Jekyll 筛选 tag 的实现 | TaoAlpha's Blog"><meta property="og:description" content="主要介绍下如何实现不同category下tag的展现以及筛选的实现, 效果模拟简书的tag"><meta property="og:url" content="undefined"><meta property="og:image" content="http://taoalpha.github.io/images/newblog.jpg"><meta property="og:type" content="website"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.6.0/hint.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="TaoAlpha's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="TaoAlpha's Blog" type="application/rss+xml">
</head><body class="post"><aside class="home-menu"><nav class="home-icon-con upside"><a href="/blog/" class="home-menu-icon brand">涛</a><a href="/blog/timeline" class="home-menu-icon"><i class="fas fa-map-marker-alt"></i></a><a aria-label="Click to take you to the search box." class="home-menu-icon search-trigger hint--right"><i class="fas fa-search"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact hidden"><a href="https://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="https://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="https://taoalpha.github.io" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="https://douban.com/people/129154019" target="something"><img src="https://img3.doubanio.com/favicon.ico" alt="douban"></a></div></nav><nav class="home-icon-con downside"><a href="/blog/rss2.xml" class="home-menu-icon rss"><i class="fas fa-rss"></i></a><a href="/blog/about/" class="home-menu-icon"><i class="fas fa-smile"></i></a><span id="dark-mode" class="home-menu-icon hidden"><i class="fas fa-adjust"></i></span></nav></aside><div class="stars"></div><div class="twinkling"></div><div id="progress-bar" class="hidden"><span class="bg"></span></div><article id="content"><div class="main"><section class="entry"><h1 class="entry-title">Jekyll 筛选 tag 的实现</h1><div class="meta-top"><a href="https://taoalpha.github.io"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2015-05-07</span><span class="wordage">3686 words</span><span class="readspeed">11 minutes to read</span></div><div class="entry-content"><p>对于blog而言, 利用categories和tags的筛选是非常方便的, 而在jekyll部署的静态博客中也能轻松的实现这一点的. 本文(也即本博客)中效果主要模仿<a href="http://jianshu.com/" target="_blank" rel="noopener">简书</a>.</p>
<h2 id="展现categories以及tags"><a href="#展现categories以及tags" class="headerlink" title="展现categories以及tags"></a>展现categories以及tags</h2><blockquote>
<p>首先我们需要设定了tags的post… 这样你的<code>site.tags</code>才会有数据~ 具体的tags设定方法可以参照 <a href="/blog/2015/05/07/tech-jekyll-tips-1/">心得(1)</a><br>接着就是如何展现tags数据了~ 以本文为例, 我总计有三个category, 因为要实现不同category下的tag只出现在自己的category页面下方, 所以在展现tags的时候需要做一个category的判定.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&#123;% assign tags &#x3D; &quot;all&quot; %&#125;</span><br><span class="line">&#x2F;&#x2F; 设置变量, 这里用all来表示默认的第一个tag, 代表全部tags的情况</span><br><span class="line">&#123;% for post in site.posts %&#125;</span><br><span class="line">    &#x2F;&#x2F; 取所有的post出来逐一判定, 这里未来post很多的话, 会进行数量限制, 目前数量太少, 就糙着用啦</span><br><span class="line">    &#123;% for tag in post.tags %&#125;</span><br><span class="line">        &#x2F;&#x2F; 取post自己的tags出来, 逐一进行判定是否已经在tags数组列表中了</span><br><span class="line">        &#123;% unless tags contains tag %&#125;</span><br><span class="line">            &#x2F;&#x2F; 为了去掉重复的tag~</span><br><span class="line">            &#123;% capture tags %&#125;&#123;&#123; tags &#125;&#125;|&#123;&#123; tag &#125;&#125;&#123;% endcapture %&#125;</span><br><span class="line">            &#x2F;&#x2F; 把所有不在tags数组中的tag都加到tags中</span><br><span class="line">        &#123;% endunless %&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&#123;% assign alltags &#x3D; tags | split: &#39;|&#39; %&#125;</span><br><span class="line">&#x2F;&#x2F; 生成一个新的数组, 似乎本身liquid中没有直接append数组的方法... 看到此处的朋友有知道的请不吝告知~</span><br><span class="line">&lt;ul class&#x3D;&quot;tags&quot;&gt;</span><br><span class="line">&#123;% for tag in alltags %&#125;</span><br><span class="line">&#x2F;&#x2F; 展现tag</span><br><span class="line">&lt;a href&#x3D;&quot;javascript:;&quot; data-rel&#x3D;&quot;&#123;&#123; tag &#125;&#125;&quot; class&#x3D;&quot;filter tag &#123;% if tag &#x3D;&#x3D; &#39;all&#39;  %&#125;active&#123;% endif %&#125;&quot; &gt;&#123;&#123; tag &#125;&#125;&lt;&#x2F;a&gt;</span><br><span class="line">&#x2F;&#x2F; 这里的data-rel是为了筛选做的准备, 后文会介绍</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

<p>如此基本就实现了tags在特定category下的展现.</p>
<h2 id="根据tag进行筛选"><a href="#根据tag进行筛选" class="headerlink" title="根据tag进行筛选"></a>根据tag进行筛选</h2><p>有了tags之后, 就可以进一步做筛选了. 基本的思路是在不考虑分页的情况下, 筛选基本就是针对当前展现出来的文章列表做对应的展现隐藏控制.</p>
<blockquote>
<p>利用<code>data-rel</code>(随意指定data后面的名称即可)存储要筛选的tag, 如上;<br>在post中加上tags的数据标签:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line">&lt;li class&#x3D;&quot;post&quot; data-filter&#x3D;&quot;&#123;&#123; post.tags|join:&#39; &#39; &#125;&#125;&quot;&gt;</span><br><span class="line">&#x2F;&#x2F; 因为post.tags本身就是一个array类型, 所以这里直接用空格链接填入一个&#96;data-filter&#96;中即可;</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>利用js实现点击筛选的控制:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">".filter"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 由tag点击事件出发</span></span><br><span class="line">    <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !$<span class="keyword">this</span>.hasClass(<span class="string">"active"</span>) ) &#123;</span><br><span class="line">        <span class="comment">// 排除当前已选tag, 新tag标记active</span></span><br><span class="line">        $(<span class="string">".filter"</span>).removeClass(<span class="string">"active"</span>);</span><br><span class="line">        $<span class="keyword">this</span>.addClass(<span class="string">"active"</span>); <span class="comment">// set the active tab</span></span><br><span class="line">        <span class="keyword">var</span> $filter = $<span class="keyword">this</span>.data(<span class="string">"rel"</span>); </span><br><span class="line">        <span class="comment">// 获得要筛选的tag名称</span></span><br><span class="line">        $filter == <span class="string">'all'</span> ? </span><br><span class="line">            <span class="comment">// 对all做单独判断, 基本就是全展现</span></span><br><span class="line">            $(<span class="string">".post"</span>)</span><br><span class="line">            .not(<span class="string">":visible"</span>)</span><br><span class="line">            .fadeIn() </span><br><span class="line">        : <span class="comment">// 否则的话, 利用filter进行tag匹配的判断</span></span><br><span class="line">            $(<span class="string">".post"</span>)</span><br><span class="line">            .fadeOut(<span class="number">0</span>)</span><br><span class="line">            .filter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">// 判断post中是否包含此tag, 这里用array来判断而不是直接文本判断就是为了防止出现类似tag和tags这种局部包含的误判</span></span><br><span class="line">                <span class="keyword">return</span> $(<span class="keyword">this</span>).data(<span class="string">"filter"</span>).split(<span class="string">" "</span>).indexOf($filter)!=<span class="number">-1</span>; </span><br><span class="line">            &#125;)</span><br><span class="line">            .fadeIn(<span class="number">1000</span>); </span><br><span class="line">    &#125; <span class="comment">// endif</span></span><br><span class="line">&#125;); <span class="comment">// endon</span></span><br></pre></td></tr></table></figure>

<p>这里都用的是fadeIn,fadeOut的动效, 你当然可以修改成自己的~ 这里的实现主要参照了<a href="http://www.jqueryrain.com/?http://www.picssel.com/demos/fboxfilteredgallery.html" target="_blank" rel="noopener">jQuery filter with fancybox</a>, 不过原理其实很简单的~</p>
<h2 id="tags限制"><a href="#tags限制" class="headerlink" title="tags限制"></a>tags限制</h2><p>随着post的增多, 你会发现自己的tags也越来越庞大, 如果全部展现的话, 一是太多, 二呢, 展现也不方便, 毕竟我目前的css样式只考虑了两行的情况, 所以呢, 还是需要对tags的展现做一些限制的.</p>
<p>有两种思路:</p>
<ul>
<li><p>利用jekyll的plugin直接在生成层控制, 每次随机出一些tag就行了;</p>
</li>
<li><p>利用js在展现层控制, 所有tag都生成出来, 但是由js控制随机展现一部分;</p>
</li>
</ul>
<p>最终我用的还是第二种思路, 第一种思路主要缺点是在编译生成的时候控制的话, 只有每次重新编译才会重新生成, 和我希望的访问随机需求不符合.</p>
<p>实现方法也很容易, 基本就是利用Math.random()来生成随机数即可.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomTags</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> originArray = $(<span class="string">'ul.tags'</span>).find(<span class="string">'a.tag'</span>)</span><br><span class="line">    originArray.eq(<span class="number">0</span>).show();</span><br><span class="line">    <span class="comment">// 确保 all 每次都展现</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">var</span> index = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*originArray.length)+<span class="number">1</span></span><br><span class="line">        <span class="comment">// 没有做虑重处理, 所以很可能展现出来的tag没有10个; 想做的话也容易, 循环过程中加个是否显示了的判断即可, 这里就不做了~</span></span><br><span class="line">        originArray.eq(index).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如上, 对于jekyll的tags和categories的探索就先这样了~ 以后有什么更加有趣的想法或者发现了再补充~</p>
<p>See ya.</p>
</div><div class="post-info"><span class="category"><i class="fas fa-briefcase"></i><a href="/blog/categories/tech">tech</a></span><span class="tags"><i class="fas fa-tags"></i><a href="/blog/tags/js">js</a><a href="/blog/tags/tips">tips</a><a href="/blog/tags/jekyll">jekyll</a><a href="/blog/tags/jekyll-tags">jekyll tags</a></span></div></section><div class="widgets"><aside id="menuIndex" class="sidenav hidden"></aside><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><div class="related-posts sidenav"><h2>Related Posts:</h2><ul class="article-list"><li><a href="/blog/2016/08/27/tech-type-check-in-js/">Type check in JS</a></li><li><a href="/blog/2016/08/13/tech-deep-copy-in-javascript/">Deep copy in javascript</a></li><li><a href="/blog/2016/06/17/tech-javascript-module-system/">Javascript Module Standard</a></li><li><a href="/blog/2016/04/29/tech-defineproperty-in-javascript/">defineProperty in JavaScript</a></li><li><a href="/blog/2016/04/28/tech-symbol-and-iterate-object-in-es6/">Symbol and Iterate Object in ES6</a></li></ul></div><aside class="sidenav"><div class="recent-posts"><h2>Recent Posts:</h2><ul class="article-list"><li><a href="/blog/2020/07/04/travel-working-holiday-visa-3/">打工度假 (三)</a></li><li><a href="/blog/2020/07/02/travel-working-holiday-visa-2/">打工度假 (二)</a></li><li><a href="/blog/2020/07/02/tech-what-i-have-done-to-restart-this-blog/">我都做了哪些来复活本博客的</a></li><li><a href="/blog/2020/07/01/travel-working-holiday-visa/">打工度假 (一)</a></li><li><a href="/blog/2020/06/30/tech-gitment-and-gittalk/">Gitment and Gitalk</a></li></ul></div></aside></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><div class="comments"><script>const gitment = new Gitment({
  id: new Date('Thu May 07 2015 07:00:00 GMT-0400').toISOString(),
  owner: 'taoalpha',
  repo: 'blog',
  oauth: {
    client_id: '875872ffb3955d0ffe20',
    client_secret: '46040668c536860a9e2e9a8508c513309e3840b5',
  },
});
gitment.render(document.querySelector('.comments'));
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>