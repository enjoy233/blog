<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> jQuery的5个小细节-5 Little Known Details About jQuery Methods | TaoAlpha's Blog</title><meta name="description" content="Here is my new blog based on hexo."><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:title" content="jQuery的5个小细节-5 Little Known Details About jQuery Methods | TaoAlpha's Blog"><meta property="og:description" content="Here is my new blog based on hexo."><meta property="og:url" content="undefined"><meta property="og:image" content="http://taoalpha.github.io/images/newblog.jpg"><meta property="og:type" content="website"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hint.css/2.6.0/hint.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/blog/atom.xml" title="TaoAlpha's Blog" type="application/atom+xml">
<link rel="alternate" href="/blog/rss2.xml" title="TaoAlpha's Blog" type="application/rss+xml">
</head><body class="post"><aside class="home-menu"><nav class="home-icon-con upside"><a href="/blog/" class="home-menu-icon brand">涛</a><a href="/blog/timeline" class="home-menu-icon"><i class="fas fa-map-marker-alt"></i></a><a aria-label="Click to take you to the search box." class="home-menu-icon search-trigger hint--right"><i class="fas fa-search"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact hidden"><a href="https://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="https://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="https://taoalpha.github.io" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="https://douban.com/people/129154019" target="something"><img src="https://img3.doubanio.com/favicon.ico" alt="douban"></a></div></nav><nav class="home-icon-con downside"><a href="/blog/rss2.xml" class="home-menu-icon rss"><i class="fas fa-rss"></i></a><a href="/blog/about/" class="home-menu-icon"><i class="fas fa-smile"></i></a><span id="dark-mode" class="home-menu-icon hidden"><i class="fas fa-adjust"></i></span></nav></aside><div class="stars"></div><div class="twinkling"></div><div id="progress-bar" class="hidden"><span class="bg"></span></div><article id="content"><div class="main"><section class="entry"><h1 class="entry-title">jQuery的5个小细节-5 Little Known Details About jQuery Methods</h1><div class="meta-top"><a href="https://taoalpha.github.io"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2014-08-05</span><span class="wordage">4303 words</span><span class="readspeed">13 minutes to read</span></div><div class="entry-content"><p>其实CS真的是一个非常博大精深的课程啊… 不说其他.. 单纯说前端的这些技巧… 感觉穷其一生都难以学通学懂… 很难想象计算机的发明还不到70年… 人类的进步果然是无法想象的…</p>
<p>====正题=====jQuery的5个小技巧============================<br>Author: <a href="http://www.sitepoint.com/author/aderosa/" target="_blank" rel="noopener">Aurelio De Rosa</a><br>Published: 4 Aug, 2014<br>Source: <a href="http://www.sitepoint.com/5-little-known-details-jquery-methods//" target="_blank" rel="noopener">SitePoint</a></p>
<p>jQuery作为世界上使用最广泛的js库已经广为人知了. 虽然近来出现了很多批评的声音, 但是它依然吸引着众多的开发者. 无论你是一个jQuery的入门者还是已然晋升专家级别(Dave Methvin和其他的jQuery团队成员就除外了…), 你可能都对一些jQuery的特殊属性比较陌生. 本文将会讨论其中五个小的特性.</p>
<h3>Returing <i>false</i> in Event Binders</h3>

<p>如我们所知, jQuery的首要目的是统一各个浏览器的行为. 从而可能会对一些浏览器的属性有所增强, 整合一些本来浏览器可能不支持的功能. 想想那些多亏了jQuery你才能在IE6,7上使用的选择器,比如:not, :last-child等等.</p>
<p>但是, 虽然很少见, jQuery还是会出现一些异常表现的. 一个简单的例子就是在jQuery的事件处理中, 比如一个on()事件, 返回false的表现和如下的调用效果是完全一样的:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">event.stopPropagation();</span><br><span class="line">event.preventDefault();</span><br></pre></td></tr></table></figure>

<p>这一问题从jQuery的源代码中可以得到验证的:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( ret !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">   <span class="keyword">if</span> ( (event.result = ret) === <span class="literal">false</span> ) &#123;</span><br><span class="line">      event.preventDefault();</span><br><span class="line">      event.stopPropagation();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3>Pseudo-selectors Do More Than You Think</h3>
在jQuery对很多伪类的文档描述中, 你可以看到如下的备注(下例是:checkbox的):
<blockquote>
$( “:checkbox” ) is equivalent to $( “[type=checkbox]” ). As with other pseudo-class selectors (those that begin with a “:”) it is recommended to precede it with a tag name or some other selectors; otherwise, the universal selector (“*”) is implied. In other words, the bare $(‘:checkbox’) is equivalent to $( “*:checkbox” ), so $( “input:checkbox” ) should be used instead.    
</blockquote>
我们看下真实的代码部分:

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createInputPseudo</span>(<span class="params"> type </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"> elem </span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> name = elem.nodeName.toLowerCase();</span><br><span class="line">        <span class="keyword">return</span> name === <span class="string">"input"</span> &amp;&amp; elem.type === type;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如你所见, 备注中有些表述错误: $(‘:checkbox’)实际上应该等同于$(‘input[type=”checkbox”]’). 因为它搜寻的是input标签(name===”input”), 不过它依然会测试所有符合你制定要求的元素(比如你制定了一个上级div内的:checkbox,或者一个class等).</p>
<p>因此, 你可能很希望以后使用:checkbox的时候都不用在前面加上对应的元素名了… 都用下面这种..</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> $checkboxes = $(<span class="string">':checkbox'</span>);</span><br></pre></td></tr></table></figure>

<p>实际上, 就单纯从性能来说, 更明确的之处元素所在会更好的帮助jQuery定位到元素的. 所以, 最好还是写成如下形式:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> $checkboxes = $(<span class="string">'input:checkbox'</span>);</span><br></pre></td></tr></table></figure>

<h3>jQuery.type()</h3>
哈哈, 看名称似乎就已经很陌生了吧~ 你注意到jQuery有一个方法可以判断一个对象的类型吗?

<p>即便你已经知道这个方法, 但你依然有可能忽略了它和js本身typeof函数的区别. 实际上, jQuery.type()返回的是一个更加准确的类型. 比如:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// typeof examples:</span></span><br><span class="line"><span class="comment">// prints objects</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">null</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// prints objects</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// prints objects</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">3</span>));</span><br></pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// $.type() examples:</span></span><br><span class="line"><span class="comment">// prints null</span></span><br><span class="line"><span class="built_in">console</span>.log($.type(<span class="literal">null</span>));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// prints array</span></span><br><span class="line"><span class="built_in">console</span>.log($.type([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// prints number</span></span><br><span class="line"><span class="built_in">console</span>.log($.type(<span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">3</span>)));</span><br></pre></td></tr></table></figure>

<p>所以说, 如果你要开发jQuery插件, 你可能需要用到$.type()来获得更准确的数据类型.</p>
<h3>attr() can removeAttr()</h3>
有些糊涂? 哈, 首先, 对于不了解attr()函数的童鞋, 这是一个获取或者赋予第一个匹配的目标元素的属性的函数.
实际上, attr()不仅可以支持传入数字或者字符串, 同时也可以支持传入null来充当第二个参数(第一个参数是要赋予或者获取的属性名称, 比如src等--译者注). 一旦传入null, 那么其实就实现了removeAttr()的功能, 从而会去除这一属性. 
不信? 看看源代码~

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">attr: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, name, value </span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">if</span> ( value !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> ( value === <span class="literal">null</span> ) &#123;</span><br><span class="line">            jQuery.removeAttr( elem, name );</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如上, attr()调用后会先判断传入的value是不是undefined(如果是undefined, 就会转入获取环节–译者注),不是的话, 会先判断是不是null, 如果是的话, 会自动调用removeAttr()的.</p>
<p>这一技巧在你要对某个属性进行条件性赋值的时候最为方便, 比如:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$(selector).attr(anAttr, condition ? value : <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<p>就不用写成这样了:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">condition ? $(selector).attr(anAttr, value) : $(selector).removeAttr(anAttr);</span><br></pre></td></tr></table></figure>

<p>你应不应该使用这一技巧呢? 这就得由你来判断了.. 如果我是你的话, 为了代码的清晰,我可能不会使用它. 目前来说, 这一部分还没有在文档中出现, 而且这里还有一个<a href="https://github.com/jquery/api.jquery.com/issues/523" target="_blank" rel="noopener">相关的讨论</a>, 有兴趣的话, 可以点开看看哈.</p>
<h3>Turning Array-like Objects Into Arrays</h3>
js包含了很多数据类型, 比如nodeList, 或者函数接受的arguments变量,都是类似于array的类型, 但是都不是array. 这意味着我们可以用类似array的方法来操作其中的元素,比如arguments[0], 但是却无法使用一些array的函数, 比如:forEach(),join()等.
假如我们有一个Dom的nodeList:

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> list = <span class="built_in">document</span>.getElementsByClassName(<span class="string">'book'</span>);</span><br></pre></td></tr></table></figure>

<p>如果我们想要对一个类似array的数据使用forEach()函数, 我们不能直接调用forEach()函数的, 会报错’Uncaught TypeError: undefined is not a function’. 为了避免这类错误, 最常用的方法是利用prototype属性和call()函数:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.forEach.call(list, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;);</span><br></pre></td></tr></table></figure>

<p>或者你可以写成:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[].forEach.call(list, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;);</span><br></pre></td></tr></table></figure>

<p>无论你使用哪种, 都不是很优雅(…靠..译者注). 幸运的是, jQuery提供了一个解决方法~ 那就是jQuery.makeArray()函数:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$.makeArray(list).forEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;...&#125;);</span><br></pre></td></tr></table></figure>

<p>好很多了有木有!!!</p>
<h3>Conclusions</h3>
从本文你可以学到什么? 除了上述这5个小技巧之外, 我们希望告诉你, 即便如jQuery这样牛X而且坚实的项目也不是10分完美的. 它依然有一些bug和文档问题, 而只有源码才是可以让你信任的信息来源. 当然, 源码有时候也能够因为不同开发者的目的而有所区别... 这是另一个话题了..

<p>还有一点就是你应该对自己所学习和使用的框架和库保持好奇心, 阅读它们的源代码, 并尝试从中学到新的知识和技巧.</p>
<p>作为最后一个建议, 如果你热爱jQuery, 如我这般, 请作出你的贡献吧~ 即使只是报告一个bug或者修正一个小小的文档问题也能够帮助到数以百万计的开发者们.</p>
<p>为了以防你问我我是如何注意到这些细节问题的, 秘密就在于我写过好基本关于jQuery的书籍… 而且 欧文十一个jQuery问题跟进者!</p>
</div><div class="post-info"><span class="category"><i class="fas fa-briefcase"></i><a href="/blog/categories/readings">readings</a></span><span class="tags"><i class="fas fa-tags"></i><a href="/blog/tags/%E8%AF%91%E7%B3%BB%E5%88%97">译系列</a><a href="/blog/tags/%E7%BF%BB%E8%AF%91%E6%96%87%E7%AB%A0">翻译文章</a><a href="/blog/tags/coding">coding</a><a href="/blog/tags/jquery">jquery</a></span></div></section><div class="widgets"><aside id="menuIndex" class="sidenav hidden"></aside><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><div class="related-posts sidenav"><h2>Related Posts:</h2><ul class="article-list"><li><a href="/blog/2015/03/08/readings-what-is-pythonic/">What is Pythonic?</a></li><li><a href="/blog/2015/02/16/readings-reloading-python-modules/">Reloading Python Modules</a></li><li><a href="/blog/2014/12/05/readings-read-a-brief-history-of-web-design/">网页设计简史</a></li><li><a href="/blog/2014/12/04/readings-read-google-did-a-good-thing-kill-annoying-type-identification-code/">Google又做了一件大好事:干掉了烦人的识别型验证码!</a></li><li><a href="/blog/2014/11/27/readings-talk-about-application-of-colors-in-the-market/">谈谈颜色在市场方面的应用</a></li></ul></div><aside class="sidenav"><div class="recent-posts"><h2>Recent Posts:</h2><ul class="article-list"><li><a href="/blog/2020/07/06/thoughts-recommendation-to-new-grads-on-job-choices/">给新计算机毕业生在工作选择上的一些建议</a></li><li><a href="/blog/2020/07/04/travel-working-holiday-visa-3/">打工度假 (三)</a></li><li><a href="/blog/2020/07/02/travel-working-holiday-visa-2/">打工度假 (二)</a></li><li><a href="/blog/2020/07/02/tech-what-i-have-done-to-restart-this-blog/">我都做了哪些来复活本博客的</a></li><li><a href="/blog/2020/07/01/travel-working-holiday-visa/">打工度假 (一)</a></li></ul></div></aside></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"><script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script><div class="comments"><script>const gitment = new Gitment({
  id: new Date('Tue Aug 05 2014 01:00:00 GMT-0400').toISOString(),
  owner: 'taoalpha',
  repo: 'blog',
  oauth: {
    client_id: '875872ffb3955d0ffe20',
    client_secret: '46040668c536860a9e2e9a8508c513309e3840b5',
  },
});
gitment.render(document.querySelector('.comments'));
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>